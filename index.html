<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>BigSurBar</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <link rel="stylesheet" media="screen" href="css/style.css">
</head>
<body>
    <div id="bar">
        <ul class="right-section">
            

            <li id="music-item" onclick="api.media.togglePlayPause();" xui-hide="media.isStopped">
                <span class="itemText rightText semibold max85" id="music-Name">Music Name</span>
                <div id="itemIcon" xui-show="media.isPlaying">
                    <div class="music-icon mpause"></div>
                </div>
                <div id="itemIcon" xui-hide="media.isPlaying"> 
                    <div class="music-icon mplay"></div>
                </div>
            </li>

            <li id="bt-signal" style="display: block;">
                <div id="itemIcon">
                    <div class="bt-icon" id="bt-icon"></div>
                </div>
            </li>

            <li id="wifi-signal" style="display: block;">
                <span class="itemText rightText semibold max85" id="wifi-SSID">DarkT</span>
                <div id="itemIcon">
                    <div class="wifi-icon" id="wifi-icon"></div>
                </div>
            </li>

            <li id="cellular-signal" style="display: none;">
                <span class="itemText rightText semibold" id="cellular-type">4G</span>
                <div id="itemIcon">
                    <div class="cellular-icon" id="cellular-icon"></div>
                </div>
            </li>

            <li>
                <span class="itemText semibold" id="battery-percentage">100% </span>
                <div id="itemIcon">
                    <div class="Bt-Icon-Inner" id="battery-percentage-icon"></div>
                    <div class="Bt-Icon-Outer"></div>
                </div>
            </li>

            <li id="TimeNow" class="firstItemRight" onclick="showDate()" style="display: block;">Mon 0:00</li>
            <li id="DateNow" class="firstItemRight" style="display: none;">15/03/2021</li>
        </ul>
        <ul class="left-section">
            <a href="https://twitter.com/_DarkT_">
            <li>
                <span class="itemText mainText rightText semibold" id="apple-icon">BigSurBar</span>
                <div id="itemIcon">
                    <div class="apple-icon"></div>
                </div>
            </li></a>

        </ul>
    </div>
<script>
    function updateTime(){
        var date = new Date();
        var weekdays = new Array(7);
        weekdays[0] = "Sun";
        weekdays[1] = "Mon";
        weekdays[2] = "Tue";
        weekdays[3] = "Wed";
        weekdays[4] = "Thu";
        weekdays[5] = "Fri";
        weekdays[6] = "Sat";
        var dayName = weekdays[date.getDay()];
        var hours = date.getHours();
        var minutes = date.getMinutes();
        var ampm = hours >= 12 ? 'PM' : 'AM';
        hours = hours % 12;
        hours = hours ? hours : 12;
        minutes = minutes < 10 ? '0'+minutes : minutes;
        var strTime = hours + ':' + minutes + ' ' + ampm;
        var Total = dayName + " " + strTime
        var year = date.getFullYear();
        var month = date.getMonth() + 1;
        var day = date.getDate();
        day = day < 10 ? '0'+day : day;
        month = month < 10 ? '0'+month : month;
        document.getElementById("TimeNow").innerText = Total;
        document.getElementById("DateNow").innerText = day + "/" + month + "/" + year;
    }
    api.resources.observeData(function (newData) {
            var bp = newData.battery.percentage;
            var isCharging = newData.battery.state;
            if(isCharging == 1){
                document.getElementById("battery-percentage-icon").classList.add("isCharging");
            }else{
                document.getElementById("battery-percentage-icon").classList.remove("isCharging");
                document.getElementById("battery-percentage-icon").style.width = (parseInt(bp) / 100 * 25).toString() + "px";
                if(parseInt(bp) <= 15){
                    document.getElementById("battery-percentage-icon").style.background = "#ff1212";
                }else{
                    document.getElementById("battery-percentage-icon").style.background = "";
                }
            }
            document.getElementById('battery-percentage').innerText = bp + "%";
            
        });
        api.comms.observeData(function (newData) {
            if(newData.telephony.airplaneMode){
                document.getElementById("cellular-signal").style.display = "block";
                document.getElementById("cellular-type").innerText = "";
                document.getElementById("cellular-icon").style.background = "url(img/airplane.png)";
            }else {
                if(newData.telephony.type != "" && newData.telephony.operator != ""){
                // Device supported cellular
                document.getElementById("cellular-signal").style.display = "block";
                document.getElementById("cellular-type").innerText = newData.telephony.operator + " " + newData.telephony.type;
                document.getElementById("cellular-icon").style.background = "url(img/signal" + newData.telephony.bars.toString() +  ".png)";
                }else{
                    document.getElementById("cellular-signal").style.display = "none";
                }
            }
            
            if(newData.wifi.enabled !== false && newData.wifi.ssid !== ""){
                // Device supported cellular
                document.getElementById("wifi-signal").style.display = "block";
                document.getElementById("wifi-SSID").innerText = newData.wifi.ssid;
                document.getElementById("wifi-icon").style.background = "url(img/wifi" + (newData.wifi.bars) +  ".png)";
            }else{
                document.getElementById("wifi-signal").style.display = "none";
            }

            if(newData.bluetooth.enabled !== false){
                // Device supported cellular
                document.getElementById("bt-signal").style.display = "block";
                if(newData.bluetooth.devices.length > 0){
                    document.getElementById("bt-icon").style.background = "url(img/bluetooth-connected.png)";
                }else{
                    document.getElementById("bt-icon").style.background = "url(img/bluetooth.png)";
                }
            }else{
                document.getElementById("bt-signal").style.display = "none";
            }
        });
        api.media.observeData(function (newData) {
            if(!newData.isStopped){
                document.getElementById("music-Name").style.display = "block";
                document.getElementById("music-Name").innerText = newData.nowPlaying.title;
            }
        });
        
    setInterval(function(){
        updateTime();
    },1000)
    function showDate(){
        document.getElementById("TimeNow").style.display = "none";
        document.getElementById("DateNow").style.display = "block";
        setTimeout(function(){
            document.getElementById("TimeNow").style.display = "block";
            document.getElementById("DateNow").style.display = "none";
        }, 2000);
    }
</script>
</body></html>